## 0. 키워드 추출
- sustainable_management_report_crawling.ipynb : 《K-ESG 가이드라인 v1.0》의 진단항목명을 통해 추출한 키워드 → SEED로 사용
	- E : 36개
	- S : 50개
	- G : 55개
- esg_keyword_extraction.ipynb : SEED 키워드 기반으로 《지속가능경영보고서》에서 키워드 추출 → 뉴스 텍스트를 E, S, G 항목으로 분류할 때 사용
	- 코스피200에 속한 회사 중 110개의 회사의 지속가능경영보고서(pdf 366개)에서 추출된 213,973개의 문장에서 키워드 추출
		- E : 261개
		- S : 213개
		- G : 240개

## 1. 크롤링
- DART_kosdaq_crawling.ipynb
	- OpenDART를 통해 고유 번호, 회사명, 종목코드, 수정일 크롤링
	- 코스닥에 속한 회사 1718개를 선별해 정보 크롤링 (CORPCODE.xml 파일 사용)
	- 최대주주 관련 정보(최대주주 성명, 최대주주 관계, 최대주주 주식종류, 최대주주 기초주식수, 최대주주 기초주식지분율, 최대주주 기말주식수, 최대주주 기말주식지분율) 크롤링
	- 소액주주 관련 정보(소액주주수, 주주수, 소액주주비율, 소액주주 주식수, 총주식수, 소액주주 주식지분율) 크롤링
	- 감사의견 관련 정보(감사의견, 감사의견 강조사항, 감사의견 핵심감사사항) 크롤링
	- 2023년, 2022년도의 자료만 크롤링 (이전 자료는 NaN 값으로, 사용할 수 없으므로)
- kosdaq_jobplanet_crawler.ipynb
	- S,G에 특화된 잡플래닛 리뷰텍스트와 수치 데이터 크롤링
	[잡플래닛 크롤링 대상]
		- 수치 데이터(11개 항목) : 1. 복지평점   2. 복지개수   3. 리뷰평점   4. 복지 및 급여   5. 워라밸   6. 사내문화 7. 승진기회및가능성  8. 경영진 점수  9. 기업추천율(%)  10. ceo지지율(%)  11. 성장가능성(%)
		- 텍스트 데이터(2개 항목) : 1. 장점 리뷰  2. 단점 리뷰
	[점수 책정 방식]
		1. S(사회) 점수 책정
			a. 점수 도출 공식 : (((복지평점 + 복지개수 + 복지 및 급여 + 워라밸) / 4) * ((성장가능성 + 기업추천율) / 2 * 0.01)) * 2
			b. 점수 범위 : 0 ~ 10 (최소 ~ 최대)
			c. 실제 점수 범위 : 0.05716 ~ 7.888 (최소 ~ 최대)
		2. G(지배구조) 점수 책정
			a. 점수 도출 공식 : ((사내문화 + 승진기회 및 가능성 + 경영진) / 3) * (ceo지지율 * 0.01)) * 2
			b. 점수 범위 : 0~10(최소~최대)
			c. 실제 점수 범위 : 0.16 ~ 10.0 (최소 ~ 최대)
- naver_news_crawling
	- kobert train data : 코스피200에 속한 기업명을 기반으로 년도별 검색 100,987개의 기사를 모음
	- kobert test data : 코스닥 기업 1718개의 기업명을 통하여 2019~2024년도별 1~12월별로 뉴스기사 594,200개의 기사를 모음
- Patent_report_crawling.ipynb
	- 코스닥 상장 기업 회사명 추출
	- KIPRIS 특허사이트에 특허정보 검색
	- 코스닥에 속한 회사 1718개를 선별해 정보 크롤링
	- 1718개의 회사 특허내용 추출하여 크롤링
	- 각 특허 내용의 출원일자와 특허등록한 날짜 크롤링 (16414개)

- green_company_crawl.ipynb
    - 환경기술산업 원스톱 서비스(ECO SQUARE)의 녹색제품 인증기업 수집
	- 녹색제품은 환경표지, GR(재활용), 저탄소인증 총 세가지이며 모두 통합하여 기업별,연도별 가산점 책정
	- 현재 인증된 녹색제품 4512개의 회사명, 인증연도, 제품명 크롤링
	- 이중 코스닥에 속한 56개의 회사를 선별
	- 녹색제품 존재 여부에 따라 전체 코스닥 기업의 E 가산점 부여

- recall_company_crawl.ipynb
    - 국가기술 표준원(KATS)의 유해기업 수집
    - 자발적리콜, 명령에 따른 리콜, 권고에 따른 리콜로 분류되어 있어 리콜 종류에 따른 가산점 점수 책정
	- 현재 3668개의 리콜 항목의 회사명, 연도, 리콜종류, 제품명 크롤링
    - 이중 코스닥에 속한 18개의 회사를 선별
	- 리콜 여부에 따라 전체 코스닥 기업의 S 가산점 부여




## 2. 전처리
- DART_kosdaq_preprocessing.ipynb
	- 숫자 결측치의 경우(소액주주수, 주주수, 소액주주_주식수, 총주식수), 0으로 결측치 처리
	- 비율 결측치의 경우(소액주주비율, 소액주주_주식지분율), 평균값 사용하여 결측치 처리
- bert_train_preprocessing.ipynb
	-  100,987개의 뉴스 기사 문장화 954,452개의 문장, train을 위한 전처리 및 seedword기반 라벨링 후 489,528개의 문장 학습데이터로 이용
- bert_test_preprocessing.ipynb
	- 594,200개의 데이터 전처리 및 문장화 4,571,733개의 데이터 기업별,년도별 bert_test_input을 위해 자료구조 변환
- Patent_report_preprocessing.ipynb
	- 기업별 특허 출원번호 제거
	- [], (), {}, <> 괄호와 괄호 안 문자 제거
	-'...외', '...총' 제거
	-"" 기준으로 분할

## 3. 데이터베이스 구축
- Tableau Architecture기반으로 ERD설계 및 데이터베이스 구축

## 4. 모델링
- KoBERT
	[Fine-Tuning]
		1. ESG fine-tuning 진행
		2. 긍정 부정 fine-tuning 진행
	[훈련용 텍스트 데이터 & 훈련]
		0. input 대상 : KOSPI 200 기준
		1. 긍정, 부정 : 네이버 영화 리뷰 긍부정 데이터(15만 개) + 잡플래닛 장점/단점 리뷰(7만 개) = 총 22만개 텍스트 데이터 사용
			a. 긍정 텍스트 부정 텍스트 비율 =  5 : 5
			b. 학습 결과 : valid_data 기준 90%대
			c. 모델 구조
				i ) kobert + nn.Linear(hidden, 2) => out
		2. ESG : 네이버 뉴스(100만 개) + 잡플래닛 장점/단점 리뷰(3만 개) = 총 104만개 텍스트 데이터 사용
			a. 학습 시 라벨(ex : (e,s,g) -> (1,0,1)) 비율 일정하게 학습
			b. 학습 결과 : valid_data 기준 90%대
			c. 모델 구조
				i ) kobert + nn.Linear(hidden, 3) => out
				ii ) sigmoid(out)
	[테스트 데이터 & Test-output]
		0. input 대상 : KOSDAQ 1700개 기준 => 총 460만 개 문장 (네이버 뉴스 + 잡플래닛 리뷰)
		1. 기업 별 > 년도 별 > e, s, g, p(긍정), n(부정) 점수 = 기업의 e,s,g 추세 확인 용도
		2. 문장 별 > e, s, g, p(긍정), n(부정) 점수 =  영역 별 긍부정 단어 counting 용도

## 5. 점수 할당
- DART_kosdaq_preprocessing.ipynb
	- 점수 초기값으로 0점 설정
	- 최대주주_기말주식비율이 60 이상인 경우 1.5점, 정보가 없는 경우 3.75점, 정보가 있으면서 60 미만인 경우 7.5점 (7.5점 만점)
	- 감사의견에 적정이라는 값이 들어가 있지 않거나 값이 없는 경우는 0점, 적정이 들어간 경우는 7.5점
- 특허점수.ipynb
	- 특허 개수에 따른 점수
		- 0개 : 0점
		- 1~2개 : 1점
		- 3~4개 : 2점
		- 5~6개 : 3점
		- 7개 이상 : 3.5점
- product_point.ipynb
	- 녹색제품 점수
		- 0개 : 0점
		- 1~2개 : 2점
		- 3~4개 : 3점
		- 5개 이상 : 3.5점
	- 리콜 점수
		- 0개 : 5점
		- 1개 : 4점
		- 2개 : 3점
		- 3개 : 2점
		- 4개 : 1점
		- 5개 이상 : 0점
- ESG_count.ipynb
	- Tableau wordcloud구축을 위해 년도 ESG별 seed_words를 이용하여 카운팅
- sentiment_count.ipynb
	- 기업별 년도별 문장들 긍/부정 키워드 기반 카운팅 or KoBERT 내에서 처리한다면 삭제할 수도 있음
- 총점수.ipynb
	- 점수 데이터 모두 가져와서 E, S, G 그룹별로 가중치 주어 최종 E, S, G, 총점수 계산
		- E : (bert_e + 녹색점수 + 특허점수)/15*100
			- bert_e 기본 점수 : 15점(100점만점기준)
			- 녹색 기본 점수 : 10점(100점만점기준)
			- 특허 기본 점수 : 13점(100점만점기준)
		- S : (bert_s + job_s + 리콜점수)/40*100
			- bert_s 기본 점수 : 30점(100점만점기준)
			- 리콜 기본 점수 : 15점(100점만점기준)
			- job_s 기본 점수 : 10점(100점만점기준)
		- G : (bert_g + job_g + 다트점수)/45*100
			- bert_g 기본 점수 : 30점(100점만점기준)
			- job_g 기본 점수 : 20점(100점만점기준)
		- 총점수 : (E + S + G)/3

## 6. 시각화
- Tableau
    - Tableau_ESG_Dashboard_public용.twb
    - 전문적인 시각화 차트 Tableau를 사용하여 기업별 ESG 지표 대시보드 생성
	- 중소기업에 대한 투자와 정보 탐색을 원하는 사용자 입장에서 보기 쉽게 구성
    - 불필요한 숫자형 수치들은 줄이고, 워드클라우드, 종합 데이터 위주로 색 대비 명확하게 지정
    
	1. 화면명세서 제작
		- 디자인 공동 작업 가능한 피그마 프로그램을 사용하여 화면명세서 제작
		- ERD를 연계하여 각 페이지별 세부 디자인 계획
	2. 데이터 연결
    	- Tableau의 서버를 통해 MariaDB 데이터베이스 연결
		- 데이터베이스에 적재된 테이블을 각 요소에 맞게 서로 연결하여 그래프화할 데이터 준비  
	3. 페이지 구성
		1. 종합 페이지
			a. 기업명 검색창
			b. 종합 ESG점수 top3 기업, 급등 ESG점수 top3 기업, 급락 ESG점수 top3 기업
			c. E, S, G별 점수 기업 리스트와 대표 키워드를 나타내는 워드클라우드
			d. 급등/급락 ESG 비교 그래프, 업종별 ESG점수 변동 추이, ESG등급 비율 추이
		2. 랭킹 카테고리
			a. 전체 기업들의 ESG등수와 등급 및 전년대비 점수를 한눈에 알아볼 수 있도록 구성
			b. Total, Environment, Social, Governance 별 랭킹 리스트
		3. 기업 상세 페이지
			a. 해당 기업의 전체 ESG 등급을 상단에 배치
			b. 해당 기업의 대표 워드클라우드 및 긍/부정 비율
			c. E,S,G 점수에 따라 나타나는 다각형 그래프
			d. E,S,G 막대그래프로 연도별 ESG 변동 추이 표현
			e. 키워드를 통해 나타난 긍/부정 비율로 기업 인식 제고
	4. 대시보드 연동
		1. 대시보드 액션으로 3페이지의 대시보드를 연결하고 각 페이지를 편리하게 오갈 수 있게 구성 
		2. 기업명을 클릭하여 랭킹 카테고리 및 기업 상세 페이지로 이동
		3. 개별 아이콘을 사용하여 각 페이지로 되돌아 갈 수 있게 구현
	5. Tableau public 게시
		완성된 대시보드를 Tableau public에 공유하여 ESG 평가 및 모니터링 서비스 제안